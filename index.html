<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anchor NGN Master - KDS 14 20 54 ì „ìˆ˜ í†µí•© ì‹œìŠ¤í…œ</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Noto+Sans+KR:wght@300;400;500;700&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --primary: #1e3a8a;
            --primary-light: #3b82f6;
            --secondary: #64748b;
            --accent: #0f172a;
            --bg: #f8fafc;
            --sidebar-bg: #ffffff;
            --card-bg: #ffffff;
            --border: #e2e8f0;
            --text-main: #1e293b;
            --text-muted: #475569;
            --success: #10b981;
            --danger: #ef4444;
            --formula-bg: #f8fafc;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', 'Noto Sans KR', sans-serif;
            background-color: var(--bg);
            color: var(--text-main);
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 320px;
            background: var(--sidebar-bg);
            border-right: 1px solid var(--border);
            height: 100vh;
            position: fixed;
            overflow-y: auto;
            padding: 1.5rem 1rem;
            z-index: 1000;
        }

        .sidebar h2 {
            font-size: 1rem;
            color: var(--primary);
            font-weight: 800;
            margin-bottom: 1.5rem;
            letter-spacing: -0.02em;
            border-bottom: 2px solid var(--primary);
            padding-bottom: 0.5rem;
        }

        .nav-list {
            list-style: none;
        }

        .nav-item {
            margin-bottom: 0.3rem;
        }

        .nav-link {
            text-decoration: none;
            color: var(--text-muted);
            font-size: 0.8rem;
            padding: 0.45rem 0.6rem;
            display: block;
            border-radius: 0.3rem;
            transition: all 0.2s;
            cursor: pointer;
        }

        .nav-link:hover {
            background: #f1f5f9;
            color: var(--primary);
        }

        .nav-link.active {
            background: var(--primary);
            color: white;
            font-weight: 600;
        }

        .sub-nav {
            padding-left: 1rem;
            display: none;
            margin-top: 0.1rem;
            border-left: 1px solid var(--border);
            margin-left: 0.5rem;
        }

        .nav-item.expanded>.sub-nav {
            display: block;
        }

        /* Main Content */
        .main-content {
            margin-left: 320px;
            flex: 1;
            padding: 2.5rem;
            max-width: 1200px;
        }

        .section {
            display: none;
            animation: fadeIn 0.2s ease;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        h1 {
            font-size: 1.6rem;
            color: var(--accent);
            margin-bottom: 1.25rem;
            font-weight: 700;
            border-bottom: 3px solid var(--primary-light);
            display: inline-block;
            padding-bottom: 0.3rem;
        }

        h2 {
            font-size: 1.25rem;
            color: var(--primary);
            margin: 2rem 0 1rem;
            border-left: 5px solid var(--primary);
            padding-left: 0.75rem;
        }

        .card {
            background: var(--card-bg);
            border-radius: 0.6rem;
            padding: 1.5rem;
            border: 1px solid var(--border);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            margin-bottom: 1.5rem;
        }

        /* Dashboard */
        .dashboard {
            display: grid;
            grid-template-columns: 1fr 380px;
            gap: 1.5rem;
        }

        .input-stack {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .input-box {
            background: #fbfcfe;
            padding: 1.25rem;
            border-radius: 0.6rem;
            border: 1px solid var(--border);
        }

        .input-box h4 {
            font-size: 0.75rem;
            color: var(--primary);
            margin-bottom: 0.75rem;
            text-transform: uppercase;
            border-bottom: 1px solid var(--border);
            padding-bottom: 0.3rem;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.6rem;
        }

        .grid-4 {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.5rem;
        }

        .control {
            display: flex;
            flex-direction: column;
            gap: 0.2rem;
        }

        .control label {
            font-size: 0.7rem;
            font-weight: 600;
            color: var(--secondary);
        }

        .control input,
        .control select,
        .control textarea {
            padding: 0.4rem;
            border: 1px solid var(--border);
            border-radius: 0.3rem;
            font-size: 0.8rem;
            font-family: inherit;
        }

        /* Report */
        .report-view {
            background: white;
            border: 1px solid #000;
            padding: 2.5rem;
            color: #000;
            margin-top: 2rem;
            display: none;
        }

        .report-header {
            text-align: center;
            border-bottom: 2px solid #000;
            padding-bottom: 1rem;
            margin-bottom: 2rem;
        }

        .calc-box {
            border: 1px solid #eee;
            padding: 1.25rem;
            margin-bottom: 1.5rem;
            background: #fafafa;
            position: relative;
        }

        .trace {
            font-family: monospace;
            font-size: 0.85rem;
            color: #333;
            margin: 0.5rem 0;
            line-height: 1.5;
            white-space: pre-wrap;
        }

        .status-badge {
            display: inline-block;
            padding: 0.2rem 0.6rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            font-weight: 700;
            color: white;
            float: right;
        }

        .success-bg {
            background: var(--success);
        }

        .danger-bg {
            background: var(--danger);
        }

        .btn {
            background: var(--primary);
            color: white;
            padding: 0.8rem 1.2rem;
            border: none;
            border-radius: 0.4rem;
            cursor: pointer;
            font-weight: 700;
            font-size: 0.9rem;
        }

        .btn:hover {
            background: #1d4ed8;
        }

        @media print {

            .sidebar,
            .dashboard,
            .no-print,
            h1 {
                display: none;
            }

            .main-content {
                margin-left: 0;
                padding: 0;
            }

            .report-view {
                display: block !important;
                border: none;
            }
        }
    </style>
</head>

<body>
    <nav class="sidebar no-print">
        <h2>KDS 14 20 54 ì•µì»¤ ì„¤ê³„ ë§ˆìŠ¤í„°</h2>
        <ul class="nav-list">
            <li class="nav-item"><a class="nav-link" onclick="showSection('dashboard')">ğŸ  í†µí•© êµ¬ì¡°í•´ì„ ëŒ€ì‹œë³´ë“œ</a></li>
            <li class="nav-item expanded">
                <a class="nav-link">4. ì„¤ê³„ (DESIGN)</a>
                <ul class="sub-nav">
                    <li><a class="nav-link" onclick="showSection('s41')">4.1 ì„¤ê³„ ì¼ë°˜</a></li>
                    <li><a class="nav-link" onclick="showSection('s42')">4.2 ì•µì»¤ ê°•ë„ì— ê´€í•œ ì¼ë°˜ ê·œì •</a></li>
                    <li class="nav-item expanded">
                        <a class="nav-link">4.3 ì¸ì¥í•˜ì¤‘ì— ëŒ€í•œ ì„¤ê³„ ì¡°ê±´</a>
                        <ul class="sub-nav">
                            <li><a class="nav-link" onclick="showSection('s431')">4.3.1 ì¸ì¥ë ¥ì„ ë°›ëŠ” ì•µì»¤ì˜ ê°•ì¬ê°•ë„</a></li>
                            <li><a class="nav-link" onclick="showSection('s432')">4.3.2 ì¸ì¥ë ¥ì„ ë°›ëŠ” ì•µì»¤ì˜ ì½˜í¬ë¦¬íŠ¸ ë¸Œë ˆì´í¬ì•„ì›ƒê°•ë„</a>
                            </li>
                            <li><a class="nav-link" onclick="showSection('s433')">4.3.3 ì¸ì¥ë ¥ì„ ë°›ëŠ” ì„ ì„¤ì¹˜/í›„ì„¤ì¹˜ í™•ì¥/ì–¸ë”ì»· ì•µì»¤ì˜
                                    ë½‘í˜ê°•ë„</a></li>
                            <li><a class="nav-link" onclick="showSection('s434')">4.3.4 ì¸ì¥ë ¥ì„ ë°›ëŠ” ì•µì»¤ì˜ ì½˜í¬ë¦¬íŠ¸ì¸¡ë©´íŒŒì—´ê°•ë„</a></li>
                            <li><a class="nav-link" onclick="showSection('s435')">4.3.5 ì¸ì¥ë ¥ì„ ë°›ëŠ” ë¶€ì°©ì‹ ì•µì»¤ì˜ ë¶€ì°©ê°•ë„</a></li>
                        </ul>
                    </li>
                    <li class="nav-item expanded">
                        <a class="nav-link">4.4 ì „ë‹¨í•˜ì¤‘ì— ëŒ€í•œ ì„¤ê³„ ì¡°ê±´</a>
                        <ul class="sub-nav">
                            <li><a class="nav-link" onclick="showSection('s441')">4.4.1 ì „ë‹¨ë ¥ì„ ë°›ëŠ” ì•µì»¤ì˜ ê°•ì¬ê°•ë„</a></li>
                            <li><a class="nav-link" onclick="showSection('s442')">4.4.2 ì „ë‹¨ë ¥ì„ ë°›ëŠ” ì•µì»¤ì˜ ì½˜í¬ë¦¬íŠ¸ ë¸Œë ˆì´í¬ì•„ì›ƒê°•ë„</a>
                            </li>
                            <li><a class="nav-link" onclick="showSection('s443')">4.4.3 ì „ë‹¨ë ¥ì„ ë°›ëŠ” ì•µì»¤ì˜ ì½˜í¬ë¦¬íŠ¸í”„ë¼ì´ì•„ì›ƒê°•ë„</a></li>
                        </ul>
                    </li>
                    <li><a class="nav-link" onclick="showSection('s45')">4.5 ì¸ì¥ë ¥ê³¼ ì „ë‹¨ë ¥ì˜ ë™ì‹œ ì‘ìš©</a></li>
                    <li><a class="nav-link" onclick="showSection('s46')">4.6 ìª¼ê°¬íŒŒê´´ ë°©ì§€ ê·œì •</a></li>
                    <li><a class="nav-link" onclick="showSection('s47')">4.7 ì•µì»¤ ì„¤ì¹˜ì™€ ê²€ì‚¬ í•­ëª©</a></li>
                </ul>
            </li>
        </ul>
        <button class="btn" style="width: 100%; margin-top: 1rem;" onclick="window.print()">ì •ì‹ ë³´ê³ ì„œ ì¶œë ¥ (KDS)</button>
    </nav>

    <main class="main-content">
        <section id="dashboard" class="section active">
            <h1>6-DOF í†µí•© êµ¬ì¡°í•´ì„ ëŒ€ì‹œë³´ë“œ</h1>
            <div class="card no-print">
                <div class="dashboard">
                    <div class="input-stack">
                        <div class="input-box">
                            <h4>1. ì„¤ê³„ ì œì›</h4>
                            <div class="grid-2">
                                <div class="control"><label>Anchor Type</label>
                                    <select id="i_type" onchange="u_v()">
                                        <option value="headed">Headed Bolt</option>
                                        <option value="adh">Adhesive Anchor</option>
                                    </select>
                                </div>
                                <div class="control"><label>fck (MPa)</label><input type="number" id="i_fck" value="24"
                                        oninput="u_v()"></div>
                                <div class="control"><label>d_a (mm)</label><input type="number" id="i_da" value="20"
                                        oninput="u_v()"></div>
                                <div class="control"><label>h_ef (mm)</label><input type="number" id="i_hef" value="100"
                                        oninput="u_v()"></div>
                            </div>
                        </div>
                        <div class="input-box">
                            <h4>2. ì„¤ê³„ í•˜ì¤‘ (6-DOF)</h4>
                            <div class="grid-3">
                                <div class="control"><label>Fx (kN)</label><input type="number" id="i_fx" value="0">
                                </div>
                                <div class="control"><label>Fy (kN)</label><input type="number" id="i_fy" value="0">
                                </div>
                                <div class="control"><label>Fz (ì¸ì¥, kN)</label><input type="number" id="i_fz"
                                        value="40"></div>
                            </div>
                            <div class="grid-3" style="margin-top:0.5rem;">
                                <div class="control"><label>Mx (kNÂ·m)</label><input type="number" id="i_mx" value="2.5">
                                </div>
                                <div class="control"><label>My (kNÂ·m)</label><input type="number" id="i_my" value="1.5">
                                </div>
                                <div class="control"><label>Mz (kNÂ·m)</label><input type="number" id="i_mz" value="0.5">
                                </div>
                            </div>
                        </div>
                        <div class="input-box">
                            <h4>3. ë°°ì¹˜ ë° ì¢Œí‘œ (Asymmetric)</h4>
                            <div class="control">
                                <label>ê°œë³„ ì¢Œí‘œ (x,y; x,y; ...)</label>
                                <textarea id="i_coords" rows="2"
                                    oninput="u_v()">-75,-75; 75,-75; 75,75; -75,75</textarea>
                            </div>
                        </div>
                        <button class="btn" style="width: 100%; height: 50px;" onclick="run_master()">ì „ìˆ˜ íŒŒê´´ëª¨ë“œ ê²€í†  ë¦¬í¬íŠ¸
                            ìƒì„±</button>
                    </div>
                    <div class="visual-area">
                        <svg id="v_svg" viewBox="0 0 300 300">
                            <rect x="10" y="10" width="280" height="280" fill="#f8fafc" stroke="#e2e8f0" />
                            <g id="v_anc_g"></g>
                        </svg>
                    </div>
                </div>
            </div>

            <div id="report_area" class="report-view">
                <div class="report-header">
                    <h2>ANCHOR STRUCTURAL CALCULATION REPORT</h2>
                    <p>KDS 14 20 54 Standard Execution</p>
                </div>
                <div id="rt_content"></div>
            </div>
        </section>

        <!-- KDS Detailed Sections (4.1 to 4.7) -->
        <section id="s41" class="section">
            <h1>4.1 ì„¤ê³„ ì¼ë°˜</h1>
            <div class="card">
                <p>KDS 14 20 54ëŠ” ì¸ì¥, ì „ë‹¨ ë˜ëŠ” ë³µí•© í•˜ì¤‘ì„ ë°›ëŠ” ì½˜í¬ë¦¬íŠ¸ ì•µì»¤ì˜ ì„¤ê³„ ê¸°ì¤€ì„ ì •ì˜í•©ë‹ˆë‹¤. í•˜ì¤‘ ê²½ë¡œëŠ” ëª…í™•í•´ì•¼ í•˜ë©°, ë¶€ì¬ì˜ ì—°ì„± ë° ê°•ì„±ì„ ê³ ë ¤í•´ì•¼ í•©ë‹ˆë‹¤.</p>
            </div>
        </section>

        <section id="s42" class="section">
            <h1>4.2 ì•µì»¤ ê°•ë„ì— ê´€í•œ ì¼ë°˜ ê·œì •</h1>
            <div class="card">
                <p>ì„¤ê³„ ê°•ë„ Ï†Rnì€ ê³„ìˆ˜ í•˜ì¤‘ Raë³´ë‹¤ í¬ê±°ë‚˜ ê°™ì•„ì•¼ í•©ë‹ˆë‹¤ (Ï†Rn â‰¥ Ra). ê°•ë„ì €ê°ê³„ìˆ˜ Ï†ëŠ” íŒŒê´´ ëª¨ë“œ(ì—°ì„±/ì·¨ì„±)ì— ë”°ë¼ ê²°ì •ë©ë‹ˆë‹¤.</p>
            </div>
        </section>

        <section id="s431" class="section">
            <h1>4.3.1 ì¸ì¥ë ¥ì„ ë°›ëŠ” ì•µì»¤ì˜ ê°•ì¬ê°•ë„</h1>
            <div class="card">
                <p>ê°•ì¬ ìì²´ì˜ ì¸ì¥ íŒŒê´´ ê°•ë„ì…ë‹ˆë‹¤. Nsa = n Â· Ase,N Â· futa ê³µì‹ì„ ì‚¬ìš©í•˜ë©°, futaëŠ” 1.9 fya ë˜ëŠ” 860 MPaë¥¼ ì´ˆê³¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
            </div>
        </section>

        <section id="s432" class="section">
            <h1>4.3.2 ì¸ì¥ë ¥ì„ ë°›ëŠ” ì•µì»¤ì˜ ì½˜í¬ë¦¬íŠ¸ ë¸Œë ˆì´í¬ì•„ì›ƒê°•ë„</h1>
            <div class="card">
                <p>ì½˜í¬ë¦¬íŠ¸ì˜ ì›ë¿”í˜• íŒŒê´´ë©´ì (ANc)ì— ê¸°ì´ˆí•œ ê°•ë„ì…ë‹ˆë‹¤. Nb ê¸°ë³¸ ê°•ë„ì— ë‹¤ì–‘í•œ ë³´ì • ê³„ìˆ˜(Ïˆ)ë¥¼ ì ìš©í•˜ì—¬ ì‚°ì •í•©ë‹ˆë‹¤.</p>
            </div>
        </section>

        <section id="s433" class="section">
            <h1>4.3.3 ì¸ì¥ë ¥ì„ ë°›ëŠ” ì„ ì„¤ì¹˜/í›„ì„¤ì¹˜ í™•ì¥/ì–¸ë”ì»· ì•µì»¤ì˜ ë½‘í˜ê°•ë„</h1>
            <div class="card">
                <p>í—¤ë“œì•µì»¤ì˜ ì§€ì•• ë˜ëŠ” í™•ì¥ì— ì˜í•œ ì €í•­ë ¥ ë¶€ì¡±ìœ¼ë¡œ ë°œìƒí•˜ëŠ” ë½‘í˜ íŒŒê´´ë¥¼ ê²€í† í•©ë‹ˆë‹¤. Ïˆc,p ë³´ì •ê³„ìˆ˜ê°€ ì ìš©ë©ë‹ˆë‹¤.</p>
            </div>
        </section>

        <section id="s434" class="section">
            <h1>4.3.4 ì¸ì¥ë ¥ì„ ë°›ëŠ” ì•µì»¤ì˜ ì½˜í¬ë¦¬íŠ¸ì¸¡ë©´íŒŒì—´ê°•ë„</h1>
            <div class="card">
                <p>ë§¤ì…ê¹Šì´ê°€ ê¹Šê³  ì—°ë‹¨ê±°ë¦¬ê°€ ì§§ì€ ê²½ìš°(hef > 2.5ca1), í—¤ë“œë¶€ ì••ë ¥ì— ì˜í•œ ì¸¡ë©´ ì½˜í¬ë¦¬íŠ¸ íŒŒì—´ì„ ê²€í† í•©ë‹ˆë‹¤.</p>
            </div>
        </section>

        <section id="s435" class="section">
            <h1>4.3.5 ì¸ì¥ë ¥ì„ ë°›ëŠ” ë¶€ì°©ì‹ ì•µì»¤ì˜ ë¶€ì°©ê°•ë„</h1>
            <div class="card">
                <p>ë¶€ì°©ì¬(Adhesive)ì™€ ì½˜í¬ë¦¬íŠ¸ ì‚¬ì´ì˜ ë¶€ì°©ì‘ë ¥(Ï„rk)ì„ ê¸°ë°˜ìœ¼ë¡œ ì‚°ì •í•˜ëŠ” ê°•ë„ì…ë‹ˆë‹¤. ANa íˆ¬ì˜ë©´ì ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>
            </div>
        </section>

        <section id="s441" class="section">
            <h1>4.4.1 ì „ë‹¨ë ¥ì„ ë°›ëŠ” ì•µì»¤ì˜ ê°•ì¬ê°•ë„</h1>
            <div class="card">
                <p>ì „ë‹¨ í•˜ì¤‘ì— ì˜í•œ ë³¼íŠ¸ì˜ ì „ë‹¨ íŒŒê´´ ê°•ë„ì…ë‹ˆë‹¤. Vsa = n Â· 0.6 Â· Ase,V Â· futa ê³µì‹ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>
            </div>
        </section>

        <section id="s442" class="section">
            <h1>4.4.2 ì „ë‹¨ë ¥ì„ ë°›ëŠ” ì•µì»¤ì˜ ì½˜í¬ë¦¬íŠ¸ ë¸Œë ˆì´í¬ì•„ì›ƒê°•ë„</h1>
            <div class="card">
                <p>í•˜ì¤‘ ì‘ìš© ë°©í–¥ì˜ ì—°ë‹¨(ca1)ìœ¼ë¡œ í–¥í•˜ëŠ” ìê¸°í˜• íŒŒê´´ ê°•ë„ì…ë‹ˆë‹¤. AVc íˆ¬ì˜ë©´ì ì„ ì‚¬ìš©í•˜ì—¬ ê³„ì‚°í•©ë‹ˆë‹¤.</p>
            </div>
        </section>

        <section id="s443" class="section">
            <h1>4.4.3 ì „ë‹¨ë ¥ì„ ë°›ëŠ” ì•µì»¤ì˜ ì½˜í¬ë¦¬íŠ¸í”„ë¼ì´ì•„ì›ƒê°•ë„</h1>
            <div class="card">
                <p>ë°˜ë ¥ ì‘ìš©ì  ë°˜ëŒ€ìª½ì—ì„œ ì½˜í¬ë¦¬íŠ¸ê°€ ë“¤ë ¤ ì˜¬ë¼ê°€ëŠ” íŒŒê´´ ëª¨ë“œì…ë‹ˆë‹¤. ë¸Œë ˆì´í¬ì•„ì›ƒ ê°•ë„(Ncb)ì— kcp ê³„ìˆ˜ë¥¼ ê³±í•´ ì‚°ì •í•©ë‹ˆë‹¤.</p>
            </div>
        </section>

        <section id="s45" class="section">
            <h1>4.5 ì¸ì¥ë ¥ê³¼ ì „ë‹¨ë ¥ì˜ ë™ì‹œ ì‘ìš©</h1>
            <div class="card">
                <p>ì¸ì¥ê³¼ ì „ë‹¨ì´ ë™ì‹œì— ì‘ìš©í•  ë•Œ, Nua/Ï†Nn + Vua/Ï†Vn ì¸ ìƒí˜¸ì‘ìš© ì‹(5/3ìŠ¹)ì„ í†µí•´ ì•ˆì „ì„±ì„ ê²€ì¦í•©ë‹ˆë‹¤.</p>
            </div>
        </section>

        <section id="s46" class="section">
            <h1>4.6 ìª¼ê°¬íŒŒê´´ ë°©ì§€ ê·œì •</h1>
            <div class="card">
                <p>ì•µì»¤ ì¡°ì„ ì‹œ ì½˜í¬ë¦¬íŠ¸ê°€ ë²Œì–´ì§€ëŠ” ìª¼ê°¬ íŒŒê´´ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ ìµœì†Œ ì—°ë‹¨ê±°ë¦¬(cmin) ë° ê°„ê²©(smin) ê¸°ì¤€ì„ ì¤€ìˆ˜í•´ì•¼ í•©ë‹ˆë‹¤.</p>
            </div>
        </section>

        <section id="s47" class="section">
            <h1>4.7 ì•µì»¤ ì„¤ì¹˜ì™€ ê²€ì‚¬ í•­ëª©</h1>
            <div class="card">
                <p>ì²œê³µ ê¹Šì´, êµ¬ë© ì²­ì†Œ, ì„¤ì¹˜ í† í¬, ìŠµë„ ì¡°ê±´ ë“± í˜„ì¥ ì„¤ì¹˜ ì‹œ ë°˜ë“œì‹œ í™•ì¸í•´ì•¼ í•  í’ˆì§ˆ ê´€ë¦¬ í•­ëª©ë“¤ì…ë‹ˆë‹¤.</p>
            </div>
        </section>
    </main>

    <script>
        let anchors = [];
        function showSection(id) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }

        function u_v() {
            anchors = [];
            const raw = document.getElementById('i_coords').value.split(';');
            raw.forEach(r => {
                const xy = r.split(',');
                if (xy.length === 2) anchors.push({ x: parseFloat(xy[0]), y: parseFloat(xy[1]) });
            });
            const g = document.getElementById('v_anc_g'); g.innerHTML = '';
            anchors.forEach(a => {
                const c = document.createElementNS("http://www.w3.org/2000/svg", "circle");
                c.setAttribute("cx", 150 + a.x); c.setAttribute("cy", 150 - a.y);
                c.setAttribute("r", "5"); c.setAttribute("fill", "#1e3a8a");
                g.appendChild(c);
            });
        }

        function run_master() {
            const fck = parseFloat(document.getElementById('i_fck').value);
            const hef = parseFloat(document.getElementById('i_hef').value);
            const da = parseFloat(document.getElementById('i_da').value);
            const Fz = parseFloat(document.getElementById('i_fz').value);
            const Fx = parseFloat(document.getElementById('i_fx').value);
            const Fy = parseFloat(document.getElementById('i_fy').value);
            const Mx = parseFloat(document.getElementById('i_mx').value);
            const My = parseFloat(document.getElementById('i_my').value);
            const Mz = parseFloat(document.getElementById('i_mz').value);
            const n = anchors.length;
            const type = document.getElementById('i_type').value;

            // Load Distribution (6-DOF)
            let sumX2 = 0, sumY2 = 0;
            anchors.forEach(a => { sumX2 += a.x * a.x; sumY2 += a.y * a.y; });
            let maxNua = 0;
            anchors.forEach(a => {
                const Ni = (Fz / n) + (Math.abs(Mx) * 1e3 * Math.abs(a.y) / (sumY2 || 1)) + (Math.abs(My) * 1e3 * Math.abs(a.x) / (sumX2 || 1));
                if (Ni > maxNua) maxNua = Ni;
            });
            let maxVua = Math.sqrt(Math.pow(Fx / n, 2) + Math.pow(Fy / n, 2)) + (Math.abs(Mz) * 1e3 * 100 / (sumX2 + sumY2 || 1));

            let html = `<div class="calc-box" style="background:#eff6ff;">
                <h5>[Summary] Max Design Loads per Anchor</h5>
                <p>N_ua = <strong>${maxNua.toFixed(2)} kN</strong> | V_ua = <strong>${maxVua.toFixed(2)} kN</strong></p>
            </div>`;

            // 4.3 Tension Checks
            const Ase = (da * da * 0.7854) * 0.78;

            // 4.3.1 Steel
            const phiNsa = (n * Ase * 400 * 0.75 / 1000).toFixed(1);
            html += block("4.3.1 ì¸ì¥ ê°•ì¬ê°•ë„", `Ï† Nsa = Ï† Â· n Â· Ase Â· fya = 0.75 Â· ${n} Â· ${Ase.toFixed(1)} Â· 400`, maxNua, phiNsa);

            // 4.3.2 Breakout
            const Nb = (10 * Math.sqrt(fck) * Math.pow(hef, 1.5) / 1000).toFixed(1);
            const phiNcb = (Nb * 0.70).toFixed(1);
            html += block("4.3.2 ì¸ì¥ ë¸Œë ˆì´í¬ì•„ì›ƒê°•ë„", `Ï† Ncb = (ANc/ANc0) Â· Nb Â· Ï† = ${Nb} Â· 0.70 (ê°€ì •ì¹˜)`, maxNua, phiNcb);

            // 4.3.3 Pullout
            const phiNpn = (n * 8 * (da * da * 0.8) * fck * 0.7 / 1000).toFixed(1);
            html += block("4.3.3 ë½‘í˜ê°•ë„ (ì„ ì„¤ì¹˜/í™•ì¥/ì–¸ë”ì»·)", `Ï† Npn = Ï† Â· n Â· 8 Â· Abrg Â· fck = 0.7 Â· ${n} Â· 8 Â· ${(da * da * 0.8).toFixed(0)} Â· ${fck}`, maxNua, phiNpn);

            // 4.3.4 Side-face Blowout
            const isSBO = hef > 2.5 * 150; // Simple check
            const phiNsb = isSBO ? (13.3 * 150 * Math.sqrt(da * da * 0.8) * Math.sqrt(fck) * 0.75 / 1000).toFixed(1) : "N/A";
            html += block("4.3.4 ì¸ì¥ ì½˜í¬ë¦¬íŠ¸ì¸¡ë©´íŒŒì—´ê°•ë„", `Nsb = 13.3 Â· ca1 Â· âˆšAbrg Â· âˆšfck = ${isSBO ? phiNsb : 'ì¡°ê±´ ë¯¸ë‹¬ (ê²€ì™¸)'}`, maxNua, isSBO ? phiNsb : 9999);

            // 4.3.5 Bond (Adhesive)
            const isAdh = type === 'adh';
            const phiNag = isAdh ? (Math.PI * da * hef * 5 * 0.65 / 1000).toFixed(1) : "N/A";
            html += block("4.3.5 ë¶€ì°©ì‹ ì•µì»¤ ë¶€ì°©ê°•ë„", `Ï† Nag = Ï† Â· Ï„rk Â· Ï€ Â· da Â· hef = ${isAdh ? phiNag : 'í•´ë‹¹ì—†ìŒ'}`, maxNua, isAdh ? phiNag : 9999);

            // 4.4 Shear Checks
            // 4.4.1 Steel
            const phiVsa = (n * Ase * 400 * 0.6 * 0.65 / 1000).toFixed(1);
            html += block("4.4.1 ì „ë‹¨ ê°•ì¬ê°•ë„", `Ï† Vsa = Ï† Â· n Â· 0.6 Â· Ase Â· fya = 0.65 Â· ${n} Â· 0.6 Â· ${Ase.toFixed(1)} Â· 400`, maxVua, phiVsa);

            // 4.4.2 Breakout (Sample)
            const phiVcb = (n * 0.6 * Math.sqrt(da) * Math.sqrt(fck) * Math.pow(150, 1.5) * 0.7 / 1000).toFixed(1);
            html += block("4.4.2 ì „ë‹¨ ë¸Œë ˆì´í¬ì•„ì›ƒê°•ë„", `Ï† Vcb = (AVc/AVc0) Â· Vb Â· Ï† = ${phiVcb} kN (ê°€ì •ì¹˜)`, maxVua, phiVcb);

            // 4.4.3 Pryout
            const phiVcp = (2.0 * parseFloat(phiNcb) / 0.7 * 0.7).toFixed(1);
            html += block("4.4.3 ì „ë‹¨ í”„ë¼ì´ì•„ì›ƒê°•ë„", `Ï† Vcp = Ï† Â· kcp Â· Ncbg = 0.7 Â· 2.0 Â· ${(parseFloat(phiNcb) / 0.7).toFixed(1)}`, maxVua, phiVcp);

            // 4.5 Interaction
            const minNn = Math.min(phiNsa, phiNcb, phiNpn, (isSBO ? phiNsb : 9999), (isAdh ? phiNag : 9999));
            const minVn = Math.min(phiVsa, phiVcb, phiVcp);
            const rN = maxNua / minNn;
            const rV = maxVua / minVn;
            const ratio = (Math.pow(rN, 1.67) + Math.pow(rV, 1.67)).toFixed(3);
            html += block("4.5 ì¸ì¥ ë° ì „ë‹¨ ë™ì‹œì‘ìš©", `(Nua/Ï†Nn)^5/3 + (Vua/Ï†Vn)^5/3 = ${ratio}`, ratio, 1.0);

            document.getElementById('rt_content').innerHTML = html;
            document.getElementById('report_area').style.display = 'block';
            window.scrollTo(0, document.body.scrollHeight);
        }

        function block(title, trace, app, str) {
            const pass = parseFloat(app) <= parseFloat(str);
            return `<div class="calc-box">
                <span class="status-badge ${pass ? 'success-bg' : 'danger-bg'}">${pass ? 'PASS' : 'FAIL'}</span>
                <strong>${title}</strong><div class="trace">${trace}</div>
                <p>ì‘ìš© í•˜ì¤‘: ${parseFloat(app).toFixed(2)} kN | ì„¤ê³„ ê°•ë„: ${str} kN</p>
            </div>`;
        }

        window.onload = u_v;
    </script>
</body>

</html>